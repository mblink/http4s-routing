package org.http4s
package routing
package util

sealed abstract class Nestable[Flat, Nested](f: Flat => Nested, g: Nested => Flat) {
  final def nest(a: Flat): Nested = f(a)
  final def unnest(b: Nested): Flat = g(b)
}

object Nestable {
  def inst[Flat, Nested](f: Flat => Nested, g: Nested => Flat): Nestable[Flat, Nested] =
    new Nestable[Flat, Nested](f, g) {}

  implicit val nestable0: Nestable[Unit, Unit] =
    inst(_ => (), _ => ())

  implicit def nestable1[A1]: Nestable[A1, (Unit, A1)] =
    inst(((), _), _._2)

  /*
  Generated with this ruby code:

  def mk_tuple(ts, unit)
    ('(' * ts.length) + "#{unit}, " + ts.map { |t| t + ')' }.join(', ')
  end

  def tuple_val(ts, i)
    't' + ('._1' * (ts.length - (i + 1))) + '._2'
  end

  (2..22).each do |i|
    ts = (1..i).to_a.map { |j| "A#{j}" }

    puts(
      "implicit def nestable#{ts.length}[#{ts.join(', ')}]: Nestable[(#{ts.join(', ')}), #{mk_tuple(ts, 'Unit')}] =\n" <<
      "  inst(\n" <<
      "    t => #{mk_tuple(ts.map.with_index { |_, i| "t._#{i + 1}" }, '()')},\n" <<
      "    t => (#{ts.map.with_index { |_, i| tuple_val(ts, i) }.join(', ')}))\n\n"
    )
  end
  */

  implicit def nestable2[A1, A2]: Nestable[(A1, A2), ((Unit, A1), A2)] =
    inst(
      t => (((), t._1), t._2),
      t => (t._1._2, t._2))

  implicit def nestable3[A1, A2, A3]: Nestable[(A1, A2, A3), (((Unit, A1), A2), A3)] =
    inst(
      t => ((((), t._1), t._2), t._3),
      t => (t._1._1._2, t._1._2, t._2))

  implicit def nestable4[A1, A2, A3, A4]: Nestable[(A1, A2, A3, A4), ((((Unit, A1), A2), A3), A4)] =
    inst(
      t => (((((), t._1), t._2), t._3), t._4),
      t => (t._1._1._1._2, t._1._1._2, t._1._2, t._2))

  implicit def nestable5[A1, A2, A3, A4, A5]: Nestable[(A1, A2, A3, A4, A5), (((((Unit, A1), A2), A3), A4), A5)] =
    inst(
      t => ((((((), t._1), t._2), t._3), t._4), t._5),
      t => (t._1._1._1._1._2, t._1._1._1._2, t._1._1._2, t._1._2, t._2))

  implicit def nestable6[A1, A2, A3, A4, A5, A6]: Nestable[(A1, A2, A3, A4, A5, A6), ((((((Unit, A1), A2), A3), A4), A5), A6)] =
    inst(
      t => (((((((), t._1), t._2), t._3), t._4), t._5), t._6),
      t => (t._1._1._1._1._1._2, t._1._1._1._1._2, t._1._1._1._2, t._1._1._2, t._1._2, t._2))

  implicit def nestable7[A1, A2, A3, A4, A5, A6, A7]: Nestable[(A1, A2, A3, A4, A5, A6, A7), (((((((Unit, A1), A2), A3), A4), A5), A6), A7)] =
    inst(
      t => ((((((((), t._1), t._2), t._3), t._4), t._5), t._6), t._7),
      t => (t._1._1._1._1._1._1._2, t._1._1._1._1._1._2, t._1._1._1._1._2, t._1._1._1._2, t._1._1._2, t._1._2, t._2))

  implicit def nestable8[A1, A2, A3, A4, A5, A6, A7, A8]: Nestable[(A1, A2, A3, A4, A5, A6, A7, A8), ((((((((Unit, A1), A2), A3), A4), A5), A6), A7), A8)] =
    inst(
      t => (((((((((), t._1), t._2), t._3), t._4), t._5), t._6), t._7), t._8),
      t => (t._1._1._1._1._1._1._1._2, t._1._1._1._1._1._1._2, t._1._1._1._1._1._2, t._1._1._1._1._2, t._1._1._1._2, t._1._1._2, t._1._2, t._2))

  implicit def nestable9[A1, A2, A3, A4, A5, A6, A7, A8, A9]: Nestable[(A1, A2, A3, A4, A5, A6, A7, A8, A9), (((((((((Unit, A1), A2), A3), A4), A5), A6), A7), A8), A9)] =
    inst(
      t => ((((((((((), t._1), t._2), t._3), t._4), t._5), t._6), t._7), t._8), t._9),
      t => (t._1._1._1._1._1._1._1._1._2, t._1._1._1._1._1._1._1._2, t._1._1._1._1._1._1._2, t._1._1._1._1._1._2, t._1._1._1._1._2, t._1._1._1._2, t._1._1._2, t._1._2, t._2))

  implicit def nestable10[A1, A2, A3, A4, A5, A6, A7, A8, A9, A10]: Nestable[(A1, A2, A3, A4, A5, A6, A7, A8, A9, A10), ((((((((((Unit, A1), A2), A3), A4), A5), A6), A7), A8), A9), A10)] =
    inst(
      t => (((((((((((), t._1), t._2), t._3), t._4), t._5), t._6), t._7), t._8), t._9), t._10),
      t => (t._1._1._1._1._1._1._1._1._1._2, t._1._1._1._1._1._1._1._1._2, t._1._1._1._1._1._1._1._2, t._1._1._1._1._1._1._2, t._1._1._1._1._1._2, t._1._1._1._1._2, t._1._1._1._2, t._1._1._2, t._1._2, t._2))

  implicit def nestable11[A1, A2, A3, A4, A5, A6, A7, A8, A9, A10, A11]: Nestable[(A1, A2, A3, A4, A5, A6, A7, A8, A9, A10, A11), (((((((((((Unit, A1), A2), A3), A4), A5), A6), A7), A8), A9), A10), A11)] =
    inst(
      t => ((((((((((((), t._1), t._2), t._3), t._4), t._5), t._6), t._7), t._8), t._9), t._10), t._11),
      t => (t._1._1._1._1._1._1._1._1._1._1._2, t._1._1._1._1._1._1._1._1._1._2, t._1._1._1._1._1._1._1._1._2, t._1._1._1._1._1._1._1._2, t._1._1._1._1._1._1._2, t._1._1._1._1._1._2, t._1._1._1._1._2, t._1._1._1._2, t._1._1._2, t._1._2, t._2))

  implicit def nestable12[A1, A2, A3, A4, A5, A6, A7, A8, A9, A10, A11, A12]: Nestable[(A1, A2, A3, A4, A5, A6, A7, A8, A9, A10, A11, A12), ((((((((((((Unit, A1), A2), A3), A4), A5), A6), A7), A8), A9), A10), A11), A12)] =
    inst(
      t => (((((((((((((), t._1), t._2), t._3), t._4), t._5), t._6), t._7), t._8), t._9), t._10), t._11), t._12),
      t => (t._1._1._1._1._1._1._1._1._1._1._1._2, t._1._1._1._1._1._1._1._1._1._1._2, t._1._1._1._1._1._1._1._1._1._2, t._1._1._1._1._1._1._1._1._2, t._1._1._1._1._1._1._1._2, t._1._1._1._1._1._1._2, t._1._1._1._1._1._2, t._1._1._1._1._2, t._1._1._1._2, t._1._1._2, t._1._2, t._2))

  implicit def nestable13[A1, A2, A3, A4, A5, A6, A7, A8, A9, A10, A11, A12, A13]: Nestable[(A1, A2, A3, A4, A5, A6, A7, A8, A9, A10, A11, A12, A13), (((((((((((((Unit, A1), A2), A3), A4), A5), A6), A7), A8), A9), A10), A11), A12), A13)] =
    inst(
      t => ((((((((((((((), t._1), t._2), t._3), t._4), t._5), t._6), t._7), t._8), t._9), t._10), t._11), t._12), t._13),
      t => (t._1._1._1._1._1._1._1._1._1._1._1._1._2, t._1._1._1._1._1._1._1._1._1._1._1._2, t._1._1._1._1._1._1._1._1._1._1._2, t._1._1._1._1._1._1._1._1._1._2, t._1._1._1._1._1._1._1._1._2, t._1._1._1._1._1._1._1._2, t._1._1._1._1._1._1._2, t._1._1._1._1._1._2, t._1._1._1._1._2, t._1._1._1._2, t._1._1._2, t._1._2, t._2))

  implicit def nestable14[A1, A2, A3, A4, A5, A6, A7, A8, A9, A10, A11, A12, A13, A14]: Nestable[(A1, A2, A3, A4, A5, A6, A7, A8, A9, A10, A11, A12, A13, A14), ((((((((((((((Unit, A1), A2), A3), A4), A5), A6), A7), A8), A9), A10), A11), A12), A13), A14)] =
    inst(
      t => (((((((((((((((), t._1), t._2), t._3), t._4), t._5), t._6), t._7), t._8), t._9), t._10), t._11), t._12), t._13), t._14),
      t => (t._1._1._1._1._1._1._1._1._1._1._1._1._1._2, t._1._1._1._1._1._1._1._1._1._1._1._1._2, t._1._1._1._1._1._1._1._1._1._1._1._2, t._1._1._1._1._1._1._1._1._1._1._2, t._1._1._1._1._1._1._1._1._1._2, t._1._1._1._1._1._1._1._1._2, t._1._1._1._1._1._1._1._2, t._1._1._1._1._1._1._2, t._1._1._1._1._1._2, t._1._1._1._1._2, t._1._1._1._2, t._1._1._2, t._1._2, t._2))

  implicit def nestable15[A1, A2, A3, A4, A5, A6, A7, A8, A9, A10, A11, A12, A13, A14, A15]: Nestable[(A1, A2, A3, A4, A5, A6, A7, A8, A9, A10, A11, A12, A13, A14, A15), (((((((((((((((Unit, A1), A2), A3), A4), A5), A6), A7), A8), A9), A10), A11), A12), A13), A14), A15)] =
    inst(
      t => ((((((((((((((((), t._1), t._2), t._3), t._4), t._5), t._6), t._7), t._8), t._9), t._10), t._11), t._12), t._13), t._14), t._15),
      t => (t._1._1._1._1._1._1._1._1._1._1._1._1._1._1._2, t._1._1._1._1._1._1._1._1._1._1._1._1._1._2, t._1._1._1._1._1._1._1._1._1._1._1._1._2, t._1._1._1._1._1._1._1._1._1._1._1._2, t._1._1._1._1._1._1._1._1._1._1._2, t._1._1._1._1._1._1._1._1._1._2, t._1._1._1._1._1._1._1._1._2, t._1._1._1._1._1._1._1._2, t._1._1._1._1._1._1._2, t._1._1._1._1._1._2, t._1._1._1._1._2, t._1._1._1._2, t._1._1._2, t._1._2, t._2))

  implicit def nestable16[A1, A2, A3, A4, A5, A6, A7, A8, A9, A10, A11, A12, A13, A14, A15, A16]: Nestable[(A1, A2, A3, A4, A5, A6, A7, A8, A9, A10, A11, A12, A13, A14, A15, A16), ((((((((((((((((Unit, A1), A2), A3), A4), A5), A6), A7), A8), A9), A10), A11), A12), A13), A14), A15), A16)] =
    inst(
      t => (((((((((((((((((), t._1), t._2), t._3), t._4), t._5), t._6), t._7), t._8), t._9), t._10), t._11), t._12), t._13), t._14), t._15), t._16),
      t => (t._1._1._1._1._1._1._1._1._1._1._1._1._1._1._1._2, t._1._1._1._1._1._1._1._1._1._1._1._1._1._1._2, t._1._1._1._1._1._1._1._1._1._1._1._1._1._2, t._1._1._1._1._1._1._1._1._1._1._1._1._2, t._1._1._1._1._1._1._1._1._1._1._1._2, t._1._1._1._1._1._1._1._1._1._1._2, t._1._1._1._1._1._1._1._1._1._2, t._1._1._1._1._1._1._1._1._2, t._1._1._1._1._1._1._1._2, t._1._1._1._1._1._1._2, t._1._1._1._1._1._2, t._1._1._1._1._2, t._1._1._1._2, t._1._1._2, t._1._2, t._2))

  implicit def nestable17[A1, A2, A3, A4, A5, A6, A7, A8, A9, A10, A11, A12, A13, A14, A15, A16, A17]: Nestable[(A1, A2, A3, A4, A5, A6, A7, A8, A9, A10, A11, A12, A13, A14, A15, A16, A17), (((((((((((((((((Unit, A1), A2), A3), A4), A5), A6), A7), A8), A9), A10), A11), A12), A13), A14), A15), A16), A17)] =
    inst(
      t => ((((((((((((((((((), t._1), t._2), t._3), t._4), t._5), t._6), t._7), t._8), t._9), t._10), t._11), t._12), t._13), t._14), t._15), t._16), t._17),
      t => (t._1._1._1._1._1._1._1._1._1._1._1._1._1._1._1._1._2, t._1._1._1._1._1._1._1._1._1._1._1._1._1._1._1._2, t._1._1._1._1._1._1._1._1._1._1._1._1._1._1._2, t._1._1._1._1._1._1._1._1._1._1._1._1._1._2, t._1._1._1._1._1._1._1._1._1._1._1._1._2, t._1._1._1._1._1._1._1._1._1._1._1._2, t._1._1._1._1._1._1._1._1._1._1._2, t._1._1._1._1._1._1._1._1._1._2, t._1._1._1._1._1._1._1._1._2, t._1._1._1._1._1._1._1._2, t._1._1._1._1._1._1._2, t._1._1._1._1._1._2, t._1._1._1._1._2, t._1._1._1._2, t._1._1._2, t._1._2, t._2))

  implicit def nestable18[A1, A2, A3, A4, A5, A6, A7, A8, A9, A10, A11, A12, A13, A14, A15, A16, A17, A18]: Nestable[(A1, A2, A3, A4, A5, A6, A7, A8, A9, A10, A11, A12, A13, A14, A15, A16, A17, A18), ((((((((((((((((((Unit, A1), A2), A3), A4), A5), A6), A7), A8), A9), A10), A11), A12), A13), A14), A15), A16), A17), A18)] =
    inst(
      t => (((((((((((((((((((), t._1), t._2), t._3), t._4), t._5), t._6), t._7), t._8), t._9), t._10), t._11), t._12), t._13), t._14), t._15), t._16), t._17), t._18),
      t => (t._1._1._1._1._1._1._1._1._1._1._1._1._1._1._1._1._1._2, t._1._1._1._1._1._1._1._1._1._1._1._1._1._1._1._1._2, t._1._1._1._1._1._1._1._1._1._1._1._1._1._1._1._2, t._1._1._1._1._1._1._1._1._1._1._1._1._1._1._2, t._1._1._1._1._1._1._1._1._1._1._1._1._1._2, t._1._1._1._1._1._1._1._1._1._1._1._1._2, t._1._1._1._1._1._1._1._1._1._1._1._2, t._1._1._1._1._1._1._1._1._1._1._2, t._1._1._1._1._1._1._1._1._1._2, t._1._1._1._1._1._1._1._1._2, t._1._1._1._1._1._1._1._2, t._1._1._1._1._1._1._2, t._1._1._1._1._1._2, t._1._1._1._1._2, t._1._1._1._2, t._1._1._2, t._1._2, t._2))

  implicit def nestable19[A1, A2, A3, A4, A5, A6, A7, A8, A9, A10, A11, A12, A13, A14, A15, A16, A17, A18, A19]: Nestable[(A1, A2, A3, A4, A5, A6, A7, A8, A9, A10, A11, A12, A13, A14, A15, A16, A17, A18, A19), (((((((((((((((((((Unit, A1), A2), A3), A4), A5), A6), A7), A8), A9), A10), A11), A12), A13), A14), A15), A16), A17), A18), A19)] =
    inst(
      t => ((((((((((((((((((((), t._1), t._2), t._3), t._4), t._5), t._6), t._7), t._8), t._9), t._10), t._11), t._12), t._13), t._14), t._15), t._16), t._17), t._18), t._19),
      t => (t._1._1._1._1._1._1._1._1._1._1._1._1._1._1._1._1._1._1._2, t._1._1._1._1._1._1._1._1._1._1._1._1._1._1._1._1._1._2, t._1._1._1._1._1._1._1._1._1._1._1._1._1._1._1._1._2, t._1._1._1._1._1._1._1._1._1._1._1._1._1._1._1._2, t._1._1._1._1._1._1._1._1._1._1._1._1._1._1._2, t._1._1._1._1._1._1._1._1._1._1._1._1._1._2, t._1._1._1._1._1._1._1._1._1._1._1._1._2, t._1._1._1._1._1._1._1._1._1._1._1._2, t._1._1._1._1._1._1._1._1._1._1._2, t._1._1._1._1._1._1._1._1._1._2, t._1._1._1._1._1._1._1._1._2, t._1._1._1._1._1._1._1._2, t._1._1._1._1._1._1._2, t._1._1._1._1._1._2, t._1._1._1._1._2, t._1._1._1._2, t._1._1._2, t._1._2, t._2))

  implicit def nestable20[A1, A2, A3, A4, A5, A6, A7, A8, A9, A10, A11, A12, A13, A14, A15, A16, A17, A18, A19, A20]: Nestable[(A1, A2, A3, A4, A5, A6, A7, A8, A9, A10, A11, A12, A13, A14, A15, A16, A17, A18, A19, A20), ((((((((((((((((((((Unit, A1), A2), A3), A4), A5), A6), A7), A8), A9), A10), A11), A12), A13), A14), A15), A16), A17), A18), A19), A20)] =
    inst(
      t => (((((((((((((((((((((), t._1), t._2), t._3), t._4), t._5), t._6), t._7), t._8), t._9), t._10), t._11), t._12), t._13), t._14), t._15), t._16), t._17), t._18), t._19), t._20),
      t => (t._1._1._1._1._1._1._1._1._1._1._1._1._1._1._1._1._1._1._1._2, t._1._1._1._1._1._1._1._1._1._1._1._1._1._1._1._1._1._1._2, t._1._1._1._1._1._1._1._1._1._1._1._1._1._1._1._1._1._2, t._1._1._1._1._1._1._1._1._1._1._1._1._1._1._1._1._2, t._1._1._1._1._1._1._1._1._1._1._1._1._1._1._1._2, t._1._1._1._1._1._1._1._1._1._1._1._1._1._1._2, t._1._1._1._1._1._1._1._1._1._1._1._1._1._2, t._1._1._1._1._1._1._1._1._1._1._1._1._2, t._1._1._1._1._1._1._1._1._1._1._1._2, t._1._1._1._1._1._1._1._1._1._1._2, t._1._1._1._1._1._1._1._1._1._2, t._1._1._1._1._1._1._1._1._2, t._1._1._1._1._1._1._1._2, t._1._1._1._1._1._1._2, t._1._1._1._1._1._2, t._1._1._1._1._2, t._1._1._1._2, t._1._1._2, t._1._2, t._2))

  implicit def nestable21[A1, A2, A3, A4, A5, A6, A7, A8, A9, A10, A11, A12, A13, A14, A15, A16, A17, A18, A19, A20, A21]: Nestable[(A1, A2, A3, A4, A5, A6, A7, A8, A9, A10, A11, A12, A13, A14, A15, A16, A17, A18, A19, A20, A21), (((((((((((((((((((((Unit, A1), A2), A3), A4), A5), A6), A7), A8), A9), A10), A11), A12), A13), A14), A15), A16), A17), A18), A19), A20), A21)] =
    inst(
      t => ((((((((((((((((((((((), t._1), t._2), t._3), t._4), t._5), t._6), t._7), t._8), t._9), t._10), t._11), t._12), t._13), t._14), t._15), t._16), t._17), t._18), t._19), t._20), t._21),
      t => (t._1._1._1._1._1._1._1._1._1._1._1._1._1._1._1._1._1._1._1._1._2, t._1._1._1._1._1._1._1._1._1._1._1._1._1._1._1._1._1._1._1._2, t._1._1._1._1._1._1._1._1._1._1._1._1._1._1._1._1._1._1._2, t._1._1._1._1._1._1._1._1._1._1._1._1._1._1._1._1._1._2, t._1._1._1._1._1._1._1._1._1._1._1._1._1._1._1._1._2, t._1._1._1._1._1._1._1._1._1._1._1._1._1._1._1._2, t._1._1._1._1._1._1._1._1._1._1._1._1._1._1._2, t._1._1._1._1._1._1._1._1._1._1._1._1._1._2, t._1._1._1._1._1._1._1._1._1._1._1._1._2, t._1._1._1._1._1._1._1._1._1._1._1._2, t._1._1._1._1._1._1._1._1._1._1._2, t._1._1._1._1._1._1._1._1._1._2, t._1._1._1._1._1._1._1._1._2, t._1._1._1._1._1._1._1._2, t._1._1._1._1._1._1._2, t._1._1._1._1._1._2, t._1._1._1._1._2, t._1._1._1._2, t._1._1._2, t._1._2, t._2))

  implicit def nestable22[A1, A2, A3, A4, A5, A6, A7, A8, A9, A10, A11, A12, A13, A14, A15, A16, A17, A18, A19, A20, A21, A22]: Nestable[(A1, A2, A3, A4, A5, A6, A7, A8, A9, A10, A11, A12, A13, A14, A15, A16, A17, A18, A19, A20, A21, A22), ((((((((((((((((((((((Unit, A1), A2), A3), A4), A5), A6), A7), A8), A9), A10), A11), A12), A13), A14), A15), A16), A17), A18), A19), A20), A21), A22)] =
    inst(
      t => (((((((((((((((((((((((), t._1), t._2), t._3), t._4), t._5), t._6), t._7), t._8), t._9), t._10), t._11), t._12), t._13), t._14), t._15), t._16), t._17), t._18), t._19), t._20), t._21), t._22),
      t => (t._1._1._1._1._1._1._1._1._1._1._1._1._1._1._1._1._1._1._1._1._1._2, t._1._1._1._1._1._1._1._1._1._1._1._1._1._1._1._1._1._1._1._1._2, t._1._1._1._1._1._1._1._1._1._1._1._1._1._1._1._1._1._1._1._2, t._1._1._1._1._1._1._1._1._1._1._1._1._1._1._1._1._1._1._2, t._1._1._1._1._1._1._1._1._1._1._1._1._1._1._1._1._1._2, t._1._1._1._1._1._1._1._1._1._1._1._1._1._1._1._1._2, t._1._1._1._1._1._1._1._1._1._1._1._1._1._1._1._2, t._1._1._1._1._1._1._1._1._1._1._1._1._1._1._2, t._1._1._1._1._1._1._1._1._1._1._1._1._1._2, t._1._1._1._1._1._1._1._1._1._1._1._1._2, t._1._1._1._1._1._1._1._1._1._1._1._2, t._1._1._1._1._1._1._1._1._1._1._2, t._1._1._1._1._1._1._1._1._1._2, t._1._1._1._1._1._1._1._1._2, t._1._1._1._1._1._1._1._2, t._1._1._1._1._1._1._2, t._1._1._1._1._1._2, t._1._1._1._1._2, t._1._1._1._2, t._1._1._2, t._1._2, t._2))
}
